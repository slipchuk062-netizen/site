# РОЗДІЛ 2. РОЗРОБКА АЛГОРИТМУ ПОБУДОВИ ТУРИСТИЧНИХ КЛАСТЕРІВ РЕГІОНУ

## 2.1. Постановка задачі кластеризації туристичних об'єктів

Задача кластеризації туристичних об'єктів регіону полягає у розподілі множини туристичних локацій на групи таким чином, щоб об'єкти всередині одного кластера мали високий ступінь подібності за визначеними критеріями, а об'єкти з різних кластерів суттєво відрізнялися між собою. У контексті даного дослідження кластеризація має враховувати як просторові характеристики об'єктів, тобто географічні координати, так і їх атрибутивні властивості, зокрема категорію, рейтинг та інфраструктурне забезпечення.

Множина туристичних об'єктів регіону формально представляється як набір елементів:

**[ФОРМУЛА 2.1]** D = {o₁, o₂, ..., oₙ}

де n — загальна кількість туристичних об'єктів.

Кожен об'єкт oᵢ характеризується вектором ознак:

**[ФОРМУЛА 2.2]** oᵢ = (latᵢ, lonᵢ, catᵢ, rᵢ, aᵢ₁, aᵢ₂, ..., aᵢₘ)

де latᵢ — географічна широта об'єкта; lonᵢ — географічна довгота об'єкта; catᵢ — категорія туристичного об'єкта; rᵢ — рейтинг об'єкта за шкалою від одного до п'яти балів; aᵢ₁, aᵢ₂, ..., aᵢₘ — додаткові атрибути об'єкта.

Категорії туристичних об'єктів у межах дослідження включають сім основних типів: історичні, природні, релігійні, спортивні, гастрономічні, розважальні та інфраструктурні об'єкти. Така класифікація відповідає загальноприйнятим підходам до систематизації туристичних ресурсів та забезпечує можливість формування тематичних кластерів.

Метою кластеризації є знаходження розбиття множини туристичних об'єктів D на k непересічних підмножин C = {C₁, C₂, ..., Cₖ} таким чином, щоб мінімізувати внутрішньокластерну дисперсію та максимізувати міжкластерну відстань. Для алгоритму K-means цільова функція визначається як:

**[ФОРМУЛА 2.3]** J = Σⱼ₌₁ᵏ Σₒᵢ∈Cⱼ ||oᵢ - μⱼ||²

де μⱼ — центроїд кластера Cⱼ, який обчислюється як:

**[ФОРМУЛА 2.4]** μⱼ = (1/|Cⱼ|) × Σₒᵢ∈Cⱼ oᵢ

При розв'язанні задачі кластеризації туристичних об'єктів необхідно враховувати ряд обмежень. По-перше, оптимальна кількість кластерів має бути визначена на основі аналізу структури даних за допомогою методу ліктя та індексу силуету. По-друге, кожен кластер повинен містити не менше мінімальної кількості об'єктів для забезпечення статистичної значущості результатів: |Cⱼ| ≥ nₘᵢₙ. По-третє, усі об'єкти кластера мають знаходитися в межах адміністративних кордонів досліджуваного регіону. По-четверте, об'єкти в межах одного кластера мають демонструвати подібність за визначеними критеріями з коефіцієнтом подібності не нижче встановленого порогу.

Для оцінки якості отриманих кластерів використовуються три основні метрики. Індекс силуету (Silhouette Score) оцінює якість кластеризації на основі середньої внутрішньокластерної відстані та відстані до найближчого сусіднього кластера:

**[ФОРМУЛА 2.5]** s(oᵢ) = (b(oᵢ) - a(oᵢ)) / max{a(oᵢ), b(oᵢ)}

де a(oᵢ) — середня відстань від об'єкта oᵢ до всіх інших об'єктів того самого кластера; b(oᵢ) — мінімальна середня відстань від об'єкта oᵢ до об'єктів іншого кластера. Значення індексу силуету знаходиться в діапазоні від мінус одиниці до одиниці, де значення близькі до одиниці свідчать про чітко виражені кластери.

Індекс Девіса-Болдіна (Davies-Bouldin Index) оцінює середню подібність кожного кластера до найбільш схожого на нього:

**[ФОРМУЛА 2.6]** DBI = (1/k) × Σᵢ₌₁ᵏ maxⱼ≠ᵢ {(σᵢ + σⱼ) / d(μᵢ, μⱼ)}

де σᵢ — середня відстань від об'єктів кластера i до центроїда; d(μᵢ, μⱼ) — відстань між центроїдами кластерів i та j. Менші значення DBI свідчать про кращу якість кластеризації.

Індекс Калінського-Харабаша (Calinski-Harabasz Index) оцінює співвідношення між міжкластерною та внутрішньокластерною дисперсіями:

**[ФОРМУЛА 2.7]** CH = [tr(Bₖ) / (k-1)] / [tr(Wₖ) / (n-k)]

де tr(Bₖ) — слід матриці міжкластерної дисперсії; tr(Wₖ) — слід матриці внутрішньокластерної дисперсії; k — кількість кластерів; n — загальна кількість об'єктів. Більші значення CH свідчать про кращу якість кластеризації.


## 2.2. Обґрунтування вибору методу кластеризації

Для вирішення задачі кластеризації туристичних об'єктів було проаналізовано три основні алгоритми: K-means, DBSCAN та агломеративну кластеризацію. Кожен з цих методів має свої переваги та обмеження, що визначають доцільність їх застосування для конкретних типів задач. Порівняльний аналіз алгоритмів за ключовими критеріями наведено у таблиці 2.1.

**[ТАБЛИЦЯ 2.1]** Порівняльний аналіз алгоритмів кластеризації

| Критерій | K-means | DBSCAN | Агломеративна |
|----------|---------|--------|---------------|
| Обчислювальна складність | O(n×k×i) | O(n²) | O(n³) |
| Необхідність задання k | Так | Ні | Так |
| Форма кластерів | Сферична | Довільна | Довільна |
| Робота з шумом | Погана | Відмінна | Задовільна |
| Масштабованість | Висока | Середня | Низька |
| Інтерпретованість | Висока | Середня | Висока |
| Стабільність результатів | Залежить від ініціалізації | Висока | Висока |

*Примітка: n — кількість об'єктів, k — кількість кластерів, i — кількість ітерацій*

Алгоритм K-means характеризується лінійною обчислювальною складністю відносно кількості об'єктів, кількості кластерів та кількості ітерацій. Цей метод вимагає попереднього визначення кількості кластерів та формує кластери сферичної форми. Алгоритм демонструє погану стійкість до шуму в даних, проте забезпечує високу масштабованість та інтерпретованість результатів. Стабільність результатів залежить від початкової ініціалізації центроїдів.

Алгоритм DBSCAN має квадратичну обчислювальну складність відносно кількості об'єктів. На відміну від K-means, цей метод не вимагає попереднього визначення кількості кластерів та здатний виявляти кластери довільної форми. DBSCAN демонструє відмінну стійкість до шуму, ефективно ідентифікуючи викиди як окрему категорію. Проте алгоритм має середню масштабованість та інтерпретованість результатів.

Агломеративна кластеризація характеризується кубічною обчислювальною складністю, що суттєво обмежує її застосування для великих наборів даних. Метод вимагає визначення кількості кластерів та здатний формувати кластери довільної форми. Агломеративна кластеризація демонструє задовільну стійкість до шуму, низьку масштабованість та високу інтерпретованість завдяки можливості побудови дендрограми.

Для задачі кластеризації туристичних об'єктів Житомирської області було обрано алгоритм K-means з наступних причин. По-перше, висока обчислювальна ефективність є критичним фактором при роботі з масивом даних, що містить понад тисячу вісімсот туристичних об'єктів. Лінійна складність алгоритму забезпечує швидку обробку навіть при збільшенні обсягу даних, що особливо важливо для реалізації веб-платформи з інтерактивною візуалізацією, де користувач очікує отримати результати в режимі реального часу.

По-друге, туристичні кластери, отримані за допомогою K-means, мають чіткі центроїди, які можна інтерпретувати як типового представника кластера. Це дозволяє легко описати характеристики кожного кластера та використовувати їх для формування туристичних рекомендацій.

По-третє, на відміну від DBSCAN, який автоматично визначає кількість кластерів на основі щільності, K-means дозволяє задавати бажану кількість кластерів. Це є перевагою для регіонального планування, оскільки дозволяє формувати кластери відповідно до адміністративного поділу або стратегічних цілей розвитку туризму.

По-четверте, туристичні об'єкти в межах регіону, як правило, утворюють компактні групи навколо населених пунктів, транспортних вузлів або природних об'єктів. Такі групи добре апроксимуються сферичними кластерами, що є оптимальними для алгоритму K-means.

По-п'яте, використання методу K-means++ для початкової ініціалізації центроїдів дозволяє уникнути проблеми залежності результатів від випадкового вибору початкових точок та підвищує стабільність алгоритму.

Алгоритм K-means є ітераційним методом кластеризації, що складається з чотирьох основних кроків. На першому кроці виконується ініціалізація, під час якої обираються початкові центроїди μ₁⁽⁰⁾, μ₂⁽⁰⁾, ..., μₖ⁽⁰⁾. При використанні методу K-means++ центроїди обираються послідовно з ймовірністю, пропорційною квадрату відстані до найближчого вже обраного центроїда.

На другому кроці виконується призначення, під час якого для кожного об'єкта визначається найближчий центроїд та об'єкт призначається відповідному кластеру:

**[ФОРМУЛА 2.8]** Cⱼ⁽ᵗ⁾ = {oᵢ : ||oᵢ - μⱼ⁽ᵗ⁾|| ≤ ||oᵢ - μₗ⁽ᵗ⁾|| для всіх l = 1, ..., k}

На третьому кроці виконується оновлення, під час якого центроїди перераховуються як середнє арифметичне координат об'єктів кожного кластера:

**[ФОРМУЛА 2.9]** μⱼ⁽ᵗ⁺¹⁾ = (1/|Cⱼ⁽ᵗ⁾|) × Σₒᵢ∈Cⱼ⁽ᵗ⁾ oᵢ

На четвертому кроці виконується перевірка збіжності. Критерій збіжності визначається як:

**[ФОРМУЛА 2.10]** ||μⱼ⁽ᵗ⁺¹⁾ - μⱼ⁽ᵗ⁾|| < ε для всіх j = 1, ..., k

Якщо критерій виконується, алгоритм завершується, інакше виконується повернення до кроку призначення.


## 2.3. Опис архітектури та модулів алгоритму

Розроблена система побудови туристичних кластерів має модульну архітектуру, що складається з трьох основних рівнів: рівень даних, рівень обробки та рівень представлення. На рисунку 2.1 представлено схему загальної архітектури системи.

**[РИСУНОК 2.1]** Схема загальної архітектури системи

Рівень даних забезпечує зберігання та управління інформацією про туристичні об'єкти. Основним компонентом є база даних MongoDB, яка зберігає документи з інформацією про кожен туристичний об'єкт, включаючи географічні координати, категорію, рейтинг та додаткові атрибути. Вибір документо-орієнтованої бази даних обумовлений гнучкістю структури даних та можливістю зберігання об'єктів з різним набором атрибутів.

Рівень обробки містить модулі для виконання кластеризації та аналізу даних. Цей рівень реалізовано на мові програмування Python з використанням бібліотеки Scikit-learn для кластеризації, бібліотеки NumPy для математичних обчислень та бібліотеки Pandas для роботи з табличними даними. Асинхронна обробка запитів забезпечується фреймворком FastAPI.

Рівень представлення забезпечує візуалізацію результатів кластеризації та взаємодію з користувачем через веб-інтерфейс. Цей рівень реалізовано з використанням фреймворку React для побудови інтерфейсу та бібліотеки Leaflet для відображення інтерактивних карт. Стилізація компонентів виконана за допомогою фреймворку Tailwind CSS.

Система складається з шести функціональних модулів. Модуль завантаження даних (DataLoader) відповідає за імпорт туристичних даних з різних джерел, включаючи базу даних MongoDB, файли формату GeoJSON та CSV, а також зовнішні інтерфейси програмування додатків OpenStreetMap та Google Places. Модуль забезпечує уніфікацію формату даних та первинну валідацію.

Модуль попередньої обробки (Preprocessor) виконує очищення даних від аномалій, нормалізацію числових атрибутів та кодування категоріальних змінних. Для географічних координат застосовується стандартизація з урахуванням масштабу території досліджуваного регіону.

Модуль кластеризації (ClusteringEngine) реалізує алгоритм K-means та допоміжні методи, зокрема визначення оптимальної кількості кластерів методом ліктя, обчислення метрик якості кластеризації та візуалізацію результатів у просторі головних компонент.

Модуль геоаналізу (GeoAnalyzer) забезпечує просторовий аналіз кластерів, включаючи обчислення щільності розміщення об'єктів, визначення географічних центрів кластерів, розрахунок відстаней та побудову зон впливу.

Модуль візуалізації (Visualizer) генерує графічні представлення результатів, а саме інтерактивні карти з маркерами об'єктів та межами кластерів, діаграми розподілу об'єктів за категоріями та районами, графіки метрик якості.

Модуль програмного інтерфейсу (APIController) забезпечує RESTful інтерфейс для взаємодії між клієнтською та серверною частинами системи. Модуль реалізує кінцеві точки для отримання даних про об'єкти, виконання кластеризації та отримання аналітичних звітів.

На рисунку 2.2 представлено блок-схему алгоритму побудови туристичних кластерів.

**[РИСУНОК 2.2]** Блок-схема алгоритму побудови туристичних кластерів

На рисунку 2.3 представлено UML-діаграму класів системи кластеризації, що відображає основні класи та зв'язки між ними.

**[РИСУНОК 2.3]** UML-діаграма класів системи кластеризації


## 2.4. Етапи роботи алгоритму

Робота алгоритму побудови туристичних кластерів складається з п'яти послідовних етапів: збір та підготовка даних, нормалізація даних, визначення оптимальної кількості кластерів, виконання кластеризації та візуалізація результатів.

На першому етапі виконується збір та підготовка даних про туристичні об'єкти Житомирської області. Первинний набір даних формується на основі інформації з відкритих джерел. З OpenStreetMap отримуються географічні координати та базові атрибути об'єктів. З Google Places API отримуються рейтинги, відгуки та години роботи. Додатково використовуються офіційні реєстри туристичних об'єктів Житомирської області.

Валідація координат включає перевірку відповідності координат межам Житомирської області, виявлення та видалення дублікатів за критерієм близькості, а також корекцію координат з явними помилками. Географічні межі Житомирської області визначаються діапазоном широти від 49.44° до 51.50° північної широти та діапазоном довготи від 27.15° до 29.15° східної довготи.

Кожен туристичний об'єкт класифікується за однією з семи основних категорій. До історичних пам'яток належать музеї, замки та археологічні пам'ятки. До природних об'єктів належать парки, заповідники та водойми. До релігійних споруд належать церкви, монастирі та храми. До спортивно-рекреаційних об'єктів належать стадіони, басейни та туристичні бази. До гастрономічних закладів належать ресторани, кафе та етно-ресторани. До розважальних комплексів належать театри, кінотеатри та розважальні центри. До туристичної інфраструктури належать готелі, хостели та інформаційні центри.

Після очищення та валідації даних формується фінальна вибірка, яка для Житомирської області містить 1864 туристичних об'єкти з повним набором атрибутів.

На другому етапі виконується нормалізація даних, яка є критичним кроком, оскільки географічні координати та атрибутивні характеристики мають різні масштаби та одиниці вимірювання. Географічні координати нормалізуються за методом Z-score:

**[ФОРМУЛА 2.11]** lat_norm = (lat - μ_lat) / σ_lat

**[ФОРМУЛА 2.12]** lon_norm = (lon - μ_lon) / σ_lon

де μ_lat, μ_lon — середні значення широти та довготи відповідно; σ_lat, σ_lon — стандартні відхилення широти та довготи.

Категоріальні змінні перетворюються у числовий формат за допомогою методу one-hot encoding. Кожна категорія представляється бінарним вектором довжиною сім, відповідно до кількості категорій. Рейтинги об'єктів нормалізуються до діапазону від нуля до одиниці:

**[ФОРМУЛА 2.13]** r_norm = (r - 1) / 4

Фінальний вектор ознак для кожного об'єкта формується шляхом конкатенації нормалізованих координат, закодованих категорій та нормалізованого рейтингу. Вагові коефіцієнти дозволяють регулювати вплив різних типів ознак на результат кластеризації.

На третьому етапі виконується визначення оптимальної кількості кластерів, що є ключовим кроком для забезпечення якості кластеризації. Застосовується метод ліктя (Elbow Method), при якому алгоритм K-means виконується для діапазону значень кількості кластерів від 2 до 15. Для кожного значення обчислюється інерція:

**[ФОРМУЛА 2.14]** Inertia(k) = Σⱼ₌₁ᵏ Σₒᵢ∈Cⱼ ||oᵢ - μⱼ||²

Будується графік залежності інерції від кількості кластерів, і оптимальним вважається значення, після якого зменшення інерції стає незначним («точка ліктя»).

Паралельно виконується аналіз індексу силуету. Для кожного значення кількості кластерів обчислюється середній індекс силуету. Оптимальним є значення, що максимізує цю метрику. На основі аналізу графіка ліктя та значень індексу силуету визначається фінальна кількість кластерів. Для Житомирської області оптимальним визначено k = 7 кластерів, що відповідає точці ліктя на графіку інерції та забезпечує значення індексу силуету 0.68.

На четвертому етапі виконується безпосередня кластеризація. Алгоритм K-means++ обирає сім початкових центроїдів таким чином, щоб максимізувати відстань між ними та забезпечити рівномірне покриття простору даних. Далі виконуються ітерації призначення об'єктів до кластерів та перерахунку центроїдів до досягнення збіжності або досягнення максимальної кількості ітерацій (300). Критерієм збіжності є зміна позицій центроїдів менша за 10⁻⁴. Кожному об'єкту присвоюється мітка кластера, а кластерам присвоюються семантичні назви на основі домінуючої категорії об'єктів.

На п'ятому етапі виконується візуалізація результатів. За допомогою бібліотеки Leaflet створюється інтерактивна карта з відображенням маркерів туристичних об'єктів, кольорово закодованих за кластерами, меж районів Житомирської області у форматі GeoJSON та спливаючих вікон з детальною інформацією про об'єкти. За допомогою бібліотеки Chart.js генеруються статистичні діаграми, зокрема кругова діаграма розподілу об'єктів за категоріями, стовпчаста діаграма щільності об'єктів по районах та графік методу ліктя з позначенням оптимальної кількості кластерів. Для наочного представлення структури кластерів виконується зниження розмірності методом головних компонент (PCA) до двовимірного простору та будується точкова діаграма з кольоровим кодуванням кластерів.


## 2.5. Інтеграція алгоритму з геоінформаційною системою

Інтеграція розробленого алгоритму кластеризації з геоінформаційними інструментами забезпечує можливість просторового аналізу та інтерактивної візуалізації результатів. Для реалізації інтеграції використано бібліотеки GeoPandas та Folium.

GeoPandas є розширенням бібліотеки Pandas для роботи з геопросторовими даними. У розробленій системі GeoPandas використовується для завантаження та обробки GeoJSON-даних. Межі районів Житомирської області зберігаються у форматі GeoJSON та завантажуються як геопросторовий фрейм даних з використанням системи координат WGS84 (EPSG:4326).

GeoPandas забезпечує виконання просторових операцій, зокрема визначення приналежності точки до полігону для встановлення районної приналежності об'єктів, обчислення площі районів та щільності розміщення туристичних об'єктів, побудову буферних зон навколо об'єктів та розрахунок відстаней між об'єктами.

Для кожного району обчислюється статистика туристичних об'єктів. Спочатку виконується просторове з'єднання (spatial join) об'єктів з районами, при якому кожному туристичному об'єкту присвоюється інформація про район, до якого він належить за географічними координатами. Потім виконується агрегація даних по районах з обчисленням кількості об'єктів, середнього рейтингу та домінуючої категорії.

Folium є бібліотекою для мови Python, що забезпечує створення інтерактивних карт на основі Leaflet.js. У розробленій системі Folium інтегровано з клієнтською частиною через генерацію HTML-компонентів карти. Базова карта центрується на географічному центрі Житомирської області з координатами 50.25° північної широти та 28.67° східної довготи. Початковий масштаб карти встановлено на рівні 8, що забезпечує відображення всієї території області.

GeoJSON-полігони районів додаються на карту з кольоровим кодуванням, що відображає щільність розміщення туристичних об'єктів. Контури районів відображаються чорним кольором з товщиною лінії 2 пікселі та прозорістю заливки 50%.

Для відображення туристичних об'єктів кожному кластеру присвоюється унікальний колір. Об'єкти відображаються як кругові маркери з радіусом 6 пікселів. При натисканні на маркер відображається спливаюче вікно з назвою об'єкта та його категорією. Карта доповнюється контролем шарів, що дозволяє користувачу вмикати та вимикати відображення окремих кластерів, легендою з поясненням кольорового кодування та інструментами навігації для масштабування та переміщення по карті.

Результати візуалізації інтегруються з клієнтською частиною системи через REST API. Серверна частина на базі FastAPI генерує дані у форматі GeoJSON, які передаються на клієнтську частину для відображення за допомогою компонентів react-leaflet. Кінцева точка API повертає колекцію об'єктів GeoJSON з інформацією про кластери та їх геометрію.


## Висновки до другого розділу

У другому розділі кваліфікаційної роботи здійснено розробку алгоритму побудови туристичних кластерів регіону з використанням геоінформаційних систем.

Виконано формалізацію задачі кластеризації туристичних об'єктів, визначено вхідні дані, цільову функцію, обмеження та критерії якості. Встановлено, що для оцінки якості кластеризації доцільно використовувати комплекс метрик: індекс силуету для оцінки щільності та роздільності кластерів, індекс Девіса-Болдіна для оцінки внутрішньокластерної однорідності та індекс Калінського-Харабаша для оцінки співвідношення міжкластерної та внутрішньокластерної дисперсій.

Проведено порівняльний аналіз алгоритмів кластеризації, а саме K-means, DBSCAN та агломеративної кластеризації, та обґрунтовано вибір алгоритму K-means для вирішення поставленої задачі. Вибір обумовлений високою обчислювальною ефективністю алгоритму, інтерпретованістю результатів, можливістю контролювати кількість кластерів та природною відповідністю сферичної форми кластерів структурі туристичних даних.

Розроблено архітектуру системи побудови туристичних кластерів, що включає рівні даних, обробки та представлення. Описано структуру функціональних модулів системи: модуль завантаження даних, модуль попередньої обробки, модуль кластеризації, модуль геоаналізу, модуль візуалізації та модуль програмного інтерфейсу. Побудовано блок-схему алгоритму та діаграму класів.

Детально описано етапи роботи алгоритму: збір та підготовка даних про 1864 туристичних об'єкти Житомирської області, нормалізація даних з використанням Z-score стандартизації та one-hot encoding, визначення оптимальної кількості кластерів (k = 7) за допомогою методу ліктя та аналізу індексу силуету, виконання кластеризації з використанням алгоритму K-means++ та візуалізація результатів.

Описано інтеграцію розробленого алгоритму з геоінформаційними інструментами GeoPandas та Folium для забезпечення просторового аналізу та інтерактивної візуалізації результатів кластеризації на карті Житомирської області.

Отримані результати підтверджують ефективність розробленого алгоритму та створюють основу для програмної реалізації системи побудови туристичних кластерів, що є предметом наступного розділу кваліфікаційної роботи.
